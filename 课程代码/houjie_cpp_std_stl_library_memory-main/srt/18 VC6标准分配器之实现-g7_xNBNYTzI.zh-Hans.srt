1
00:00:04,864 --> 00:00:05,888
不同的

2
00:00:06,144 --> 00:00:08,960
编译器所附带的标准库

3
00:00:09,216 --> 00:00:13,056
里头的分配器做法可能都不一样

4
00:00:13,824 --> 00:00:18,432
所以我现在准备了三种主流编译器

5
00:00:19,200 --> 00:00:23,296
左派的这个分配器我们看看它有什么作为

6
00:00:23,808 --> 00:00:25,088
一个VC

7
00:00:26,112 --> 00:00:28,672
我这个是比较早期的版本

8
00:00:28,928 --> 00:00:35,072
咱们现在新的版本呢这个你也可以翻翻翻开你手上了手上的ps2

9
00:00:35,328 --> 00:00:37,888
2013cj studio2015

10
00:00:38,144 --> 00:00:38,656
你都可以

11
00:00:38,912 --> 00:00:40,192
找到源代码

12
00:00:40,448 --> 00:00:43,264
比较一下看它有没有长进

13
00:00:44,032 --> 00:00:46,336
我这边不再继续看新的

14
00:00:46,848 --> 00:00:52,992
Visual studio2013 2015是因为后面我们要学习的对象不是拿这个来说

15
00:00:53,248 --> 00:00:55,040
在学习是哪个公司

16
00:00:55,296 --> 00:00:56,064
那个

17
00:00:56,320 --> 00:00:58,624
号称非常棒的一个

18
00:00:59,136 --> 00:01:04,512
可以说最棒的一个是做实现但是我们现在还是来看一下笔记

19
00:01:05,024 --> 00:01:06,816
好的allocator

20
00:01:07,072 --> 00:01:07,840
在这边

21
00:01:08,608 --> 00:01:09,888
定义在这里

22
00:01:12,704 --> 00:01:15,520
Hello Kitty最重要的两个函数在这里

23
00:01:17,568 --> 00:01:19,616
好我们先去看看他做什么事情

24
00:01:19,872 --> 00:01:24,992
Allocate所做的事情我这个线条都帮你拿好了要用这个

25
00:01:26,016 --> 00:01:28,832
这个函数里面做的事情是什么

26
00:01:30,112 --> 00:01:36,000
我们已经知道operands operator new是什么了我们在第1讲已经非常清楚他了

27
00:01:36,512 --> 00:01:37,792
它的背后就是没了

28
00:01:39,328 --> 00:01:40,608
所以

29
00:01:41,376 --> 00:01:47,520
VC的这个locator的头发根本没有做任何

30
00:01:47,776 --> 00:01:48,288
的

31
00:01:48,544 --> 00:01:49,568
卫总管理

32
00:01:50,080 --> 00:01:51,616
他只是把面绕

33
00:01:52,896 --> 00:01:53,920
换一个

34
00:01:54,944 --> 00:01:55,712
样貌

35
00:01:56,224 --> 00:01:59,552
换成什么样貌换成这一个函数呈现出来

36
00:02:02,880 --> 00:02:05,184
他的兄弟allocate

37
00:02:05,952 --> 00:02:08,512
里头做的动作是operator delete

38
00:02:09,024 --> 00:02:13,120
我们在第1讲也学过了这个是什么这里那就是调用free

39
00:02:15,424 --> 00:02:20,032
所以这个老K的什么精巧的动作都没做

40
00:02:21,568 --> 00:02:27,712
这句话成了一下vc6的OK的只是以这个这个来完成这

41
00:02:27,968 --> 00:02:31,808
这个这个没有任何特殊的设计

42
00:02:33,856 --> 00:02:37,952
这个locator在VC

43
00:02:38,208 --> 00:02:39,744
容器

44
00:02:40,512 --> 00:02:42,816
所有的容器

45
00:02:43,072 --> 00:02:46,912
我没有全部列出来但是这些都是最经典的最有代表性的

46
00:02:47,680 --> 00:02:52,288
这些容器的第2个模板参数默认值都是它

47
00:02:55,872 --> 00:03:00,736
这样我们就知道了原来在VC以下你使用容器

48
00:03:01,248 --> 00:03:07,392
最终人类元素的这个分配都是靠malloc区的malloc

49
00:03:07,648 --> 00:03:08,416
带着

50
00:03:08,672 --> 00:03:10,208
没人会给你的

51
00:03:10,720 --> 00:03:12,768
那种会都带着古迹

52
00:03:13,024 --> 00:03:14,304
我们现在有这个观点

53
00:03:17,888 --> 00:03:19,424
这里的分配

54
00:03:20,192 --> 00:03:20,960
41

55
00:03:21,728 --> 00:03:23,008
你指定的

56
00:03:23,776 --> 00:03:25,312
这个

57
00:03:26,080 --> 00:03:28,896
这个元素类型为单位

58
00:03:29,920 --> 00:03:34,528
所以如果指定512意思是要分配12个整数

59
00:03:35,296 --> 00:03:36,832
如果这边指定的是

60
00:03:37,600 --> 00:03:40,672
Double那就是要分配512个double

61
00:03:41,696 --> 00:03:43,232
还是元素

62
00:03:44,000 --> 00:03:45,024
潍坊位

63
00:03:46,048 --> 00:03:52,192
我现在特别强调这一点是因为后面我们要学习的那一个很棒的那个他不是这

64
00:03:53,216 --> 00:03:55,520
它是以字节为单位
