1
00:00:00,256 --> 00:00:06,400
好到这

2
00:00:06,656 --> 00:00:12,800
这里为止他都是分配的动作继续往下

3
00:00:13,056 --> 00:00:19,200
回收那现在假设使用者应该

4
00:00:19,456 --> 00:00:25,600
正确而言应该是容器还是还原住了把第1个superblock

5
00:00:25,856 --> 00:00:32,000
打开了这些都换了于是这里要全部变成F就要变成零

6
00:00:32,256 --> 00:00:38,400
这样就是全回收我这边他那化成白色了

7
00:00:38,656 --> 00:00:44,800
给出去是灰色收还是白色这一个就是全回收这时候这个纷飞

8
00:00:45,056 --> 00:00:51,200
废弃所做的事情是他用了另外一

9
00:00:51,456 --> 00:00:57,600
Minitest他把这个秘密Victoria's

10
00:00:57,856 --> 00:01:04,000
这名字也挺好的3DS的自由链表

11
00:01:04,256 --> 00:01:10,400
其实就是一个明白在他词作就是一个秘密

12
00:01:10,656 --> 00:01:16,800
这就是情无所谓他就用了一个这个用一个元素去指责这一块

13
00:01:17,056 --> 00:01:23,200
表示回收了这一个superblock回收了

14
00:01:23,456 --> 00:01:29,600
这时候这个命令的每一个美的entry每一个元素

15
00:01:29,856 --> 00:01:34,208
是一根指针在这边的是两个尺寸

16
00:01:34,976 --> 00:01:40,352
都是master但是元素不同

17
00:01:44,448 --> 00:01:50,592
所以你可以想象有两个mini Master

18
00:01:50,848 --> 00:01:56,992
这是在说登记的是登记做登记的是全回收的

19
00:01:57,248 --> 00:01:59,296
这一边所登记的是

20
00:01:59,808 --> 00:02:03,904
是正常情况下在那边

21
00:02:04,160 --> 00:02:09,536
供应供应申请量

22
00:02:10,048 --> 00:02:12,096
9点

23
00:02:12,352 --> 00:02:18,496
所以如果这个也全回收这个也全回收是三个都全回收应该这里会有400个

24
00:02:18,752 --> 00:02:24,640
这里边的00狗应该是这样

25
00:02:25,920 --> 00:02:27,968
我们来看看这些文字

26
00:02:28,736 --> 00:02:34,880
另一个superblock全回收了于是登录到另一个bat

27
00:02:35,136 --> 00:02:38,208
也就是跟我说这个意思这一块

28
00:02:38,720 --> 00:02:40,256
主页登录制

29
00:02:40,768 --> 00:02:43,072
犹他登记的是这个头啊

30
00:02:45,376 --> 00:02:46,912
因为这一块

31
00:02:47,936 --> 00:02:50,240
可以说是又没落可拿到的

32
00:02:50,752 --> 00:02:54,592
将来是要还还还有谁要还给操作系统

33
00:02:54,848 --> 00:02:56,384
或者说还给free

34
00:02:56,640 --> 00:02:58,944
交给free

35
00:02:59,712 --> 00:03:01,760
谁还会再交给操作系统

36
00:03:02,784 --> 00:03:05,856
我想free是指示一的那个函数

37
00:03:06,368 --> 00:03:12,512
好再回来这里于是她就被登录到另一个packet就这一个了你看这边

38
00:03:12,768 --> 00:03:15,328
和他伴关系了没有任何关系了

39
00:03:15,584 --> 00:03:21,216
而下一次分配的规模将会简化

40
00:03:21,472 --> 00:03:27,616
现在已经到了64月8256下次如果有第4个superblock

41
00:03:27,872 --> 00:03:28,384
跑出来

42
00:03:28,640 --> 00:03:34,784
它的大小应该是128个区块

43
00:03:35,040 --> 00:03:41,184
而这边的我刚说他的名字叫Freedom

44
00:03:41,440 --> 00:03:47,584
这个逻辑上的名字它其实是一个mini master这里面如果

45
00:03:47,840 --> 00:03:53,984
到最多64超过64的65个superblock

46
00:03:54,240 --> 00:03:56,544
G65觉还给操作系统

47
00:03:57,568 --> 00:04:00,640
这句话

48
00:04:03,456 --> 00:04:09,600
我们再看这个变化这个是他这一个情

49
00:04:09,856 --> 00:04:16,000
情况会变成上面这个情况是什么意思呢我们看看商业

50
00:04:16,256 --> 00:04:22,399
这张图现在这个三个白的一个男子300米栏

51
00:04:22,655 --> 00:04:26,495
这是商业310懒的情况

52
00:04:28,287 --> 00:04:34,431
现在由于你是下一页由于这个全回收所以这些指针要打

53
00:04:34,687 --> 00:04:40,831
打断跟他没跟他从此没有瓜葛了这党段

54
00:04:41,087 --> 00:04:47,231
现在看下一步要打算就是打断了我画了一个

55
00:04:47,487 --> 00:04:47,999
哈哈

56
00:04:48,255 --> 00:04:53,375
这个打扮的意思是这边其实是在源代码里面他家用以root

57
00:04:54,911 --> 00:04:57,471
有一个函数将与瑞士

58
00:04:57,727 --> 00:05:01,311
那你知不知道因为是做什么发生了什么行为呢

59
00:05:02,079 --> 00:05:03,359
我告诉你

60
00:05:04,383 --> 00:05:06,431
瑞士就等同于这个元素不一样

61
00:05:07,455 --> 00:05:10,527
这个元素既然不要同中重要往这边推

62
00:05:11,039 --> 00:05:17,183
爬不起来把他本来是一个一个没有了他第2个就要变成第1个

63
00:05:19,231 --> 00:05:21,023
随时可以为是动作

64
00:05:22,815 --> 00:05:23,839
做完之后

65
00:05:24,095 --> 00:05:25,119
会变成

66
00:05:25,375 --> 00:05:27,423
这些从左往右往左边推

67
00:05:29,215 --> 00:05:30,239
往左边推

68
00:05:30,495 --> 00:05:32,799
那就形成了这样这种情况

69
00:05:35,103 --> 00:05:36,895
我要表达的是这个意思

70
00:05:39,967 --> 00:05:40,735
飞

71
00:05:41,247 --> 00:05:41,759
你在

72
00:05:43,039 --> 00:05:45,855
观看这个课程的时候如果你手上已经把

73
00:05:46,111 --> 00:05:47,391
讲义打印出来

74
00:05:47,903 --> 00:05:48,927
我的名字在

75
00:05:49,183 --> 00:05:55,327
用软件就操作了你可以在这边写上这个是什么这个就是

76
00:05:55,583 --> 00:05:57,375
赏月的状态

77
00:05:57,631 --> 00:06:02,751
经过瑞士之后才变成这一页的状态

78
00:06:07,359 --> 00:06:09,919
左下角还有两个文字我们来看看

79
00:06:15,039 --> 00:06:18,111
聚为一问一答

80
00:06:18,367 --> 00:06:19,647
自问自答

81
00:06:21,183 --> 00:06:24,767
如果第1个super_block回收2块

82
00:06:26,047 --> 00:06:27,583
但是没有权回收

83
00:06:28,607 --> 00:06:34,751
你看这一张图的意思是第1个全回收啊现在再问说不是这样

84
00:06:35,007 --> 00:06:37,055
纸回收了2块

85
00:06:37,823 --> 00:06:40,127
接下来要分配的块

86
00:06:41,151 --> 00:06:47,295
注意这些都是一样的大小三个superblock里面的区块是一样的大小

87
00:06:49,087 --> 00:06:55,231
在这里已经是回收2块然后就要分配2块那么他会从这里拿还是

88
00:06:55,487 --> 00:06:56,255
是从这里

89
00:06:59,327 --> 00:07:03,935
他们都是应该是候选人从哪里拿都可以

90
00:07:05,215 --> 00:07:09,823
我想观察他从哪里他从后面他从这里来的

91
00:07:11,359 --> 00:07:17,503
有什么道理吗也没道理都可以

92
00:07:17,759 --> 00:07:20,831
观察的结果告诉你是这样的中国明

93
00:07:21,343 --> 00:07:22,879
我们这些看

94
00:07:24,671 --> 00:07:29,279
那么如果接下来82 superblock用光

95
00:07:31,071 --> 00:07:37,215
现在是什么情况啊现在是这一个用光光了这里现在

96
00:07:37,471 --> 00:07:42,335
用光了吗20岁一个就是零吗这是1

97
00:07:42,591 --> 00:07:43,359
这事儿

98
00:07:44,127 --> 00:07:48,479
而有这么多个block现在通用光

99
00:07:48,735 --> 00:07:50,271
然后分配两个

100
00:07:50,783 --> 00:07:53,087
这时候呢

101
00:07:53,599 --> 00:07:59,743
这是什么情况刚刚直接续上的故事现在这里有两个

102
00:07:59,999 --> 00:08:02,047
这个用光了

103
00:08:02,303 --> 00:08:04,095
这个也用光了

104
00:08:04,351 --> 00:08:05,887
这里有两个

105
00:08:06,143 --> 00:08:12,287
然后再问说现在要准备两个那是从这里拿还是分配

106
00:08:12,543 --> 00:08:13,823
另外一个数值

107
00:08:17,407 --> 00:08:23,551
这时候修炼就跑出来了如果这里有区块这边却又分配另一个舒服部落

108
00:08:23,807 --> 00:08:25,599
那这个周这个手机就不好

109
00:08:27,391 --> 00:08:32,255
那么他的做法是从前面来了这是好的

110
00:08:39,935 --> 00:08:41,983
我们继续往下看

111
00:08:43,775 --> 00:08:49,919
在刚刚更新了什么这是额外插进来的问答我们见

112
00:08:50,175 --> 00:08:56,063
现在再回到这一张图所说的是一个如何把那个全回收

113
00:08:58,111 --> 00:09:02,463
三月如果第2个出发帖权回收的话

114
00:09:03,999 --> 00:09:05,279
那这边

115
00:09:05,791 --> 00:09:08,095
这叫什么叫freelist

116
00:09:08,607 --> 00:09:11,935
他就要接管他了这里就变成两个指针了

117
00:09:12,191 --> 00:09:13,983
结果这两个数若不然

118
00:09:15,007 --> 00:09:18,335
刚到64个的时候最后那个交换掉

119
00:09:20,895 --> 00:09:24,735
而原先这三个是被她来管理的

120
00:09:26,271 --> 00:09:32,415
现在这两个已经17美元了失去联络了已经换了一个人在管理了这边

121
00:09:32,671 --> 00:09:34,719
电子技术

122
00:09:36,511 --> 00:09:37,279
这个图

123
00:09:38,559 --> 00:09:44,703
下面这一个情况就是上一夜晚我们开会去看看上一夜的凉白两来

124
00:09:44,959 --> 00:09:46,495
然而220蓝

125
00:09:47,263 --> 00:09:49,567
商业就是200 200

126
00:09:52,383 --> 00:09:55,711
然后这边要失恋了咋办

127
00:09:56,479 --> 00:09:58,015
怎么把一个叉

128
00:09:58,783 --> 00:10:00,063
下咽的情况

129
00:10:00,319 --> 00:10:01,855
这里有一个叉

130
00:10:02,623 --> 00:10:05,439
这个以瑞士所做的动作我刚讲过了

131
00:10:05,951 --> 00:10:10,047
自以为是他写代码的时候对于这个要做这个操作

132
00:10:10,303 --> 00:10:14,143
这其实是拿掉那么右边权不要往左边推

133
00:10:14,911 --> 00:10:19,519
434343个往那边推就变成这样子

134
00:10:20,799 --> 00:10:23,615
他本来有四个空间所以第4个就没有用到

135
00:10:25,663 --> 00:10:26,175
电子

136
00:10:26,431 --> 00:10:30,527
在这个状态是上月的状态

137
00:10:31,039 --> 00:10:35,135
现在的这一夜就变成这一个状态

138
00:10:35,647 --> 00:10:41,791
整张图是什么意思啊这个super_block还在控制中另外两个数字

139
00:10:42,047 --> 00:10:47,167
Blog已经全回收了由这个freelist

140
00:10:54,335 --> 00:10:55,359
没有动画

141
00:10:57,663 --> 00:11:01,247
这个WiFi就是这个这个就是3DS

142
00:11:02,015 --> 00:11:08,159
它的元素排列这是一个back他的排列次序是以superblock

143
00:11:08,415 --> 00:11:09,439
大小来排

144
00:11:09,695 --> 00:11:11,231
现在这里有两个啊

145
00:11:12,255 --> 00:11:14,047
谁排在头啊你看

146
00:11:14,815 --> 00:11:16,095
这里

147
00:11:17,631 --> 00:11:19,167
这里

148
00:11:20,191 --> 00:11:21,727
是按照大小的拍的

149
00:11:23,007 --> 00:11:24,287
将来可能会有

150
00:11:24,543 --> 00:11:26,591
它会有一个红牌的动作

151
00:11:27,615 --> 00:11:29,663
这个代码里头还是一直在

152
00:11:30,175 --> 00:11:31,455
检测是不是

153
00:11:31,967 --> 00:11:34,015
按照次序地排

154
00:11:35,295 --> 00:11:36,831
因此

155
00:11:37,599 --> 00:11:43,743
当碰触到时候的人们看设定是64这个如果64

156
00:11:43,999 --> 00:11:44,511
四个时候

157
00:11:44,767 --> 00:11:46,815
碰触他们的65个郎

158
00:11:49,119 --> 00:11:53,983
的65个要放进来的时候又有一个舒服全回收了

159
00:11:54,495 --> 00:11:58,079
放进来要放进去如果新进者

160
00:11:59,103 --> 00:12:01,919
大于这个回答就是这一个栏目

161
00:12:03,711 --> 00:12:07,807
大鱼最末者最默就是最大的

162
00:12:08,575 --> 00:12:10,111
比那个还大的话

163
00:12:10,367 --> 00:12:12,415
直接把新进程杀掉

164
00:12:14,207 --> 00:12:15,231
这个比例

165
00:12:15,743 --> 00:12:17,279
就是operator delete

166
00:12:19,327 --> 00:12:20,351
不要在

167
00:12:20,607 --> 00:12:22,911
已经超过64个之后了

168
00:12:23,167 --> 00:12:25,727
看谁那么就放肆旁边那个大了

169
00:12:28,543 --> 00:12:33,663
如果先进者没有比最后那个大那么就安插到适当的位置

170
00:12:38,015 --> 00:12:41,343
总是这个意思就是当他手上有64

171
00:12:41,599 --> 00:12:45,695
Redis手上有64 1进入的65的时候

172
00:12:45,951 --> 00:12:49,535
就看看这种共识65里面谁是最大的

173
00:12:50,047 --> 00:12:53,119
Superblock谁最大最长

174
00:12:53,375 --> 00:12:54,655
把那个释放掉

175
00:12:55,935 --> 00:12:57,471
用accredited

176
00:12:57,727 --> 00:12:59,519
纵坐标

177
00:13:03,103 --> 00:13:04,127
这个就是

178
00:13:04,895 --> 00:13:06,687
Superblock的行为

179
00:13:07,711 --> 00:13:11,551
那么当三个superblock全回收的话

180
00:13:12,063 --> 00:13:13,599
这边就变成三个啦

181
00:13:14,623 --> 00:13:15,647
这里呢

182
00:13:16,415 --> 00:13:17,439
全部打

183
00:13:17,695 --> 00:13:19,999
全部都失联了都打断了

184
00:13:21,279 --> 00:13:25,119
但是master是不会有变化会缩小

185
00:13:25,375 --> 00:13:28,703
特性就这样所以在前头

186
00:13:28,959 --> 00:13:33,567
它的容量是个现在只是这四个都没有用

187
00:13:39,455 --> 00:13:41,247
左边这段话说什么

188
00:13:41,759 --> 00:13:45,855
现在这里有三个已经是失联了就已经变成了

189
00:13:46,879 --> 00:13:48,415
接下来就要分配一个

190
00:13:49,183 --> 00:13:51,487
客户又要一个怎么办呢

191
00:13:52,767 --> 00:13:54,303
这里出现的呀

192
00:13:54,815 --> 00:13:56,095
名称

193
00:13:56,351 --> 00:13:57,887
这两个名称

194
00:13:58,143 --> 00:13:59,935
一个就是这个

195
00:14:00,447 --> 00:14:03,519
另外就是这一个

196
00:14:08,127 --> 00:14:09,663
你想想看

197
00:14:09,919 --> 00:14:16,063
现在是这种情况当客户又要一个时候如果你是设计者一首诗

198
00:14:16,319 --> 00:14:18,367
上有这三个东西

199
00:14:19,391 --> 00:14:23,743
应该不要再去分配第4个出部落格吧

200
00:14:25,535 --> 00:14:28,863
没错他就做的事情这边游戏

201
00:14:30,143 --> 00:14:32,703
就把这三个的其中一个

202
00:14:32,959 --> 00:14:35,007
再挂回来

203
00:14:35,519 --> 00:14:37,055
要重新联络上

204
00:14:37,311 --> 00:14:39,871
10点了吗重新挂回来

205
00:14:40,127 --> 00:14:44,223
然后再按照前面的词的这个规则

206
00:14:51,135 --> 00:14:52,671
说复杂呢

207
00:14:53,183 --> 00:14:58,047
也算复杂但是其实这可以讲完也非常清楚

208
00:14:58,303 --> 00:14:59,583
但是这个是

209
00:15:00,095 --> 00:15:06,239
这些图都这么清晰是根据于几乎有10天的时间呢我全部买手的

210
00:15:06,495 --> 00:15:10,591
源代码里面实在显得非常的庞大

211
00:15:10,847 --> 00:15:13,663
那我非常希望各位就是站在我的肩膀上

212
00:15:15,711 --> 00:15:21,855
不需要再痛苦那一次我们只要花半小时我一小时完全清楚了她的戏

213
00:15:22,111 --> 00:15:28,255
这些行为是不适合你在你的项目里头你的容器

214
00:15:28,511 --> 00:15:30,047
气拿来使用

215
00:15:30,303 --> 00:15:32,351
那就是你的决定了

216
00:15:37,471 --> 00:15:39,263
好

217
00:15:39,519 --> 00:15:42,591
我们已经讲过了七个

218
00:15:42,847 --> 00:15:45,407
我在这第5讲里面去谈到

219
00:15:45,663 --> 00:15:48,479
格莫斯所给我们的7

220
00:15:48,735 --> 00:15:49,247
热

221
00:15:49,503 --> 00:15:50,527
扩充的

222
00:15:50,783 --> 00:15:52,063
分配器

223
00:15:53,343 --> 00:15:58,975
你可能会想最好差不多都懂了但是怎么用呢你告诉我吧

224
00:15:59,487 --> 00:16:01,535
以及下一页

225
00:16:02,047 --> 00:16:03,071
就是用法

226
00:16:04,095 --> 00:16:05,375
简单谈一下

227
00:16:05,887 --> 00:16:06,655
这边

228
00:16:06,911 --> 00:16:10,495
你要使用哪一个分配器你就要应付他

229
00:16:11,775 --> 00:16:13,823
而且是放在腾讯这里头

230
00:16:16,383 --> 00:16:17,919
这边告诉你

231
00:16:18,175 --> 00:16:23,039
这些分配器其实都是在这个特殊的名命名空间之中

232
00:16:23,295 --> 00:16:24,063
要注意

233
00:16:26,879 --> 00:16:33,023
而且这里也已经告诉你了搭配某个容器你要用的话你那个模板

234
00:16:33,279 --> 00:16:35,071
参数要怎么设定

235
00:16:37,119 --> 00:16:38,655
成都有反的例子

236
00:16:39,679 --> 00:16:41,471
这边给出两张图

237
00:16:41,983 --> 00:16:45,823
让你去再一次深刻的去回想

238
00:16:46,079 --> 00:16:47,103
这里面最

239
00:16:47,359 --> 00:16:50,431
最精巧的两个分配器一个是最肿

240
00:16:52,735 --> 00:16:56,575
一个是刚刚才谈过的那种

241
00:17:00,671 --> 00:17:01,695
下一页

242
00:17:03,231 --> 00:17:06,303
这里就是我写的一个看看

243
00:17:10,143 --> 00:17:12,191
就是就是去使用它们

244
00:17:12,703 --> 00:17:17,055
比如说某一个容器具不具备可放些元素进去

245
00:17:17,311 --> 00:17:20,639
这个容器背后用的是哪一个分配器

246
00:17:21,663 --> 00:17:22,431
当当当

247
00:17:22,943 --> 00:17:24,223
这边都有是吧

248
00:17:25,759 --> 00:17:29,343
分配委还分配归还分配归还

249
00:17:32,159 --> 00:17:34,207
我还刻意一次要两个

250
00:17:34,975 --> 00:17:37,535
在刚刚我提过了70这种动作

251
00:17:38,559 --> 00:17:42,911
容器是不会做发出这种动作你看这是我直接使用分配器

252
00:17:43,423 --> 00:17:44,191
我去做

253
00:17:44,447 --> 00:17:45,215
测试

254
00:17:48,799 --> 00:17:50,079
好只要寻找

255
00:17:50,591 --> 00:17:54,431
回到上页来只要循着这个行号走下去

256
00:17:54,943 --> 00:18:00,063
这是一个巨大的测试程序的其中一部分所以是从900多开始了

257
00:18:00,319 --> 00:18:01,855
他是这个是一个

258
00:18:02,111 --> 00:18:03,647
独立的单元

259
00:18:06,207 --> 00:18:07,231
这样

260
00:18:07,487 --> 00:18:12,351
只要去那这个持续走下去再有前面的我已经讲过了这些基础了

261
00:18:12,607 --> 00:18:14,143
一定看得懂这些

262
00:18:15,167 --> 00:18:15,679
测试

263
00:18:17,471 --> 00:18:23,615
这样就非常清楚你在使用分配器里要放哪些模板参数

264
00:18:27,199 --> 00:18:33,087
终于走走到了最后一夜的这个课程非常的庞大这个

265
00:18:33,343 --> 00:18:37,695
从平的到万丈高楼啊氛围无奖

266
00:18:38,207 --> 00:18:44,351
很深入了谈到了各种从低到高的各种内存管理的技巧

267
00:18:46,655 --> 00:18:47,167
好

268
00:18:47,935 --> 00:18:48,447
谢谢各位
