1
00:00:00,256 --> 00:00:06,400
我们来看看这个debug locator

2
00:00:09,216 --> 00:00:10,240
Class名称

3
00:00:11,008 --> 00:00:12,288
他所在的头文件

4
00:00:13,824 --> 00:00:15,616
Jclass的没有父类

5
00:00:15,872 --> 00:00:19,712
我们先看到有一些是有复那这个没有附带我发生这样

6
00:00:21,760 --> 00:00:27,392
这个里头我们要关心的是好首先注意

7
00:00:27,648 --> 00:00:29,184
他有一个模板参数

8
00:00:30,464 --> 00:00:32,256
这个模板参数

9
00:00:34,304 --> 00:00:37,376
是看名称它是又是一个OK的

10
00:00:37,888 --> 00:00:44,032
前面做了简单的介绍就是说他是一个外部外包给外部企weber另外一个

11
00:00:44,288 --> 00:00:45,824
包装起来

12
00:00:46,080 --> 00:00:48,128
那个分配就是这一个

13
00:00:50,688 --> 00:00:56,832
另外它还有一个你可以想象是总数基本上就是一个一个正数没有正负号的整数

14
00:00:57,088 --> 00:00:58,368
代表的是

15
00:00:59,392 --> 00:01:01,440
一个额外的大小

16
00:01:01,696 --> 00:01:02,720
额外的大小

17
00:01:05,536 --> 00:01:08,608
好我们来看它的分配和释放的动作

18
00:01:08,864 --> 00:01:15,008
分配动作在这里这里头所做的事情他自己并不真正分配内存它是

19
00:01:15,264 --> 00:01:16,032
调优

20
00:01:16,544 --> 00:01:18,848
绿色的这一个这一个

21
00:01:19,104 --> 00:01:25,248
这个就是被他包付钱的那个分配器让那个分配器制作分配的动作

22
00:01:25,504 --> 00:01:27,040
OK多大呢

23
00:01:28,576 --> 00:01:33,184
把客户索要索要的加上extra

24
00:01:33,696 --> 00:01:35,232
额外空间

25
00:01:35,744 --> 00:01:38,048
华盛顿是这样这是客户所要的

26
00:01:38,816 --> 00:01:39,840
Extra-thick

27
00:01:41,120 --> 00:01:44,448
这个extra是怎么来的怎么来的

28
00:01:45,984 --> 00:01:47,520
An Express

29
00:01:47,776 --> 00:01:48,800
计算出来的

30
00:01:50,080 --> 00:01:51,360
当初在

31
00:01:51,616 --> 00:01:52,896
构造函数

32
00:01:53,408 --> 00:01:59,552
你如果需要一个地方阁楼可以的你当然使用它的时候就会调用构造函数构造

33
00:01:59,808 --> 00:02:01,088
设函数在这里头

34
00:02:01,344 --> 00:02:03,648
把分配器登记起来

35
00:02:04,928 --> 00:02:07,232
他是要外包别人吗

36
00:02:07,488 --> 00:02:13,632
对外付钱的那个登记下来之后这个MX4

37
00:02:13,888 --> 00:02:14,400
显示器

38
00:02:15,168 --> 00:02:16,448
MX3

39
00:02:18,240 --> 00:02:19,264
什么来的呢

40
00:02:19,520 --> 00:02:22,080
是靠蓝色这个计算出来的

41
00:02:22,336 --> 00:02:23,360
这个函数在这里

42
00:02:25,408 --> 00:02:29,760
这个函数所做的事情你可以慢慢体会就这么两行

43
00:02:30,272 --> 00:02:35,136
其实就是把一个元素的大小

44
00:02:36,928 --> 00:02:38,976
去加上来我们看一下

45
00:02:39,232 --> 00:02:41,536
这是元素大小时绿色这一个

46
00:02:42,816 --> 00:02:47,936
要加上一个数31个数值大小三

47
00:02:48,448 --> 00:02:49,472
就是

48
00:02:50,240 --> 00:02:52,288
应该网上头看那个被我

49
00:02:52,544 --> 00:02:54,336
打掉了点甜点了

50
00:02:55,104 --> 00:02:58,432
就是一个四个字节的一个东西

51
00:02:58,944 --> 00:03:00,736
因为他要记录这个

52
00:03:01,760 --> 00:03:06,624
这个长度所以你可以想像是一个unsigned integer

53
00:03:08,160 --> 00:03:08,928
所以

54
00:03:09,440 --> 00:03:12,256
Sizeof这个词是最快的

55
00:03:13,280 --> 00:03:16,096
在绝大部分系统下都是4

56
00:03:17,376 --> 00:03:23,520
84加上每个区块的大小小区块也许是8月10日16时许是

57
00:03:23,776 --> 00:03:29,920
一次不一定加上之后捡一处这个是什么意思其实就是

58
00:03:31,968 --> 00:03:32,992
举个例子

59
00:03:33,248 --> 00:03:35,552
如果只会是八个字节

60
00:03:37,088 --> 00:03:39,136
那种数是四个字节

61
00:03:39,904 --> 00:03:41,952
这个四个字节赞

62
00:03:42,464 --> 00:03:44,000
一个区块大小吗

63
00:03:44,256 --> 00:03:45,792
他的算了就是这也是

64
00:03:48,096 --> 00:03:49,376
在一个呀

65
00:03:50,144 --> 00:03:55,264
不能360给对不对不能占领者就这个重起来不会绝对不可能是零啊

66
00:03:56,288 --> 00:03:57,312
至少是一

67
00:03:59,616 --> 00:04:00,640
也有可能是2

68
00:04:00,896 --> 00:04:02,432
不过多半也就是11了

69
00:04:03,200 --> 00:04:07,808
因为这个这个value type其实35分还不就是死

70
00:04:09,856 --> 00:04:13,440
最播放处起来就是一个意思是说

71
00:04:14,208 --> 00:04:16,512
额外的这个要占用1

72
00:04:16,768 --> 00:04:18,303
各元素怎么办

73
00:04:19,071 --> 00:04:21,119
因为现在都是语音素为单位

74
00:04:21,375 --> 00:04:25,215
啊可以回去你好好的体会质量好

75
00:04:26,239 --> 00:04:31,615
因此这个地方再回到这里来分配的时候呢就是

76
00:04:32,127 --> 00:04:38,271
呼应客户要分隔并且我再加上我刚算出来的多半是一好

77
00:04:38,527 --> 00:04:40,319
这样得到的结果

78
00:04:40,831 --> 00:04:42,367
就是真正分配出来的

79
00:04:43,647 --> 00:04:49,791
不过前头这个extra额外空间它是一个隐身在幕后的所以

80
00:04:50,303 --> 00:04:53,375
Return的时候给客户的时候就只这样移动

81
00:04:53,631 --> 00:04:55,167
一到这个白色最快的

82
00:04:55,679 --> 00:04:56,447
客户

83
00:04:56,703 --> 00:04:57,727
只看到这一块

84
00:04:58,751 --> 00:05:00,031
于是他开始用

85
00:05:01,055 --> 00:05:01,567
使用

86
00:05:02,335 --> 00:05:04,127
他们回收的时候呢

87
00:05:04,639 --> 00:05:07,455
返回来这根时针就是指向这里

88
00:05:08,479 --> 00:05:10,015
他让我们要再退回去

89
00:05:11,039 --> 00:05:15,135
在这个函数里头要叫他退回去这样才能够回收这一整块

90
00:05:18,207 --> 00:05:19,999
这是它里头的细节

91
00:05:21,023 --> 00:05:22,559
他的用意就是

92
00:05:23,327 --> 00:05:28,191
方负起另外一个分配器让分配的区块呢

93
00:05:28,447 --> 00:05:34,591
还多大一小的extra的空间用以记录整个区块的大小

94
00:05:36,639 --> 00:05:38,431
我认为是在没有用

95
00:05:40,479 --> 00:05:40,991
为什么

96
00:05:41,759 --> 00:05:46,111
这一个的身份这个扮演的角色就是类似哭泣了

97
00:05:46,367 --> 00:05:49,183
Malloc不是给你的去看待

98
00:05:52,511 --> 00:05:54,303
我们在说内存管理的时候

99
00:05:55,071 --> 00:05:57,375
这种阳春型的其实没什么用

100
00:05:58,911 --> 00:06:02,751
我们真正有用的是设计成内内存池

101
00:06:03,775 --> 00:06:07,359
设计成内存池的主要用意就是要去除

102
00:06:09,151 --> 00:06:14,271
当然他也提升了一些效率啊那个药有没有次数变少他也提升了

103
00:06:14,527 --> 00:06:16,575
最主要是去除

104
00:06:16,831 --> 00:06:22,975
你去除了cookie然后你现在把那个东西在包装为一个给打个飞的又增加这个

105
00:06:23,231 --> 00:06:25,023
这样的词在什么大

106
00:06:26,559 --> 00:06:27,839
我个人认为没有用

107
00:06:32,447 --> 00:06:33,727
这是第8个

108
00:06:34,239 --> 00:06:38,847
OK的所以就是第几个人我也忘记了反正我总共要简介绍七个

109
00:06:39,359 --> 00:06:40,383
再往下看

110
00:06:41,663 --> 00:06:44,991
接下来终于要谈到真正有用的

111
00:06:46,271 --> 00:06:51,135
2.9也就是第2讲我们花了好长时间在躺着这个东西

112
00:06:52,159 --> 00:06:53,439
下一页这个图

113
00:06:53,951 --> 00:06:54,975
手机吧

114
00:06:55,743 --> 00:06:57,535
花了好几个小时再谈这个

115
00:06:58,815 --> 00:07:04,447
那这个在回到上个月来2.9就是这一个东西我不用再说了

116
00:07:04,703 --> 00:07:07,775
这个是把前面的拖影片在拿出来再看一次

117
00:07:08,031 --> 00:07:09,311
这些容器

118
00:08:31,743 --> 00:08:32,767
这句话

119
00:08:33,023 --> 00:08:33,791
你问一下

120
00:08:34,303 --> 00:08:40,447
这些差点酒这些扩充行了分配器其中的是这一个也就是以前学过这个的话

121
00:08:47,615 --> 00:08:49,151
不过我们也分析过了

122
00:08:49,407 --> 00:08:55,551
别忘记一件事情在第2讲仔细分析这个的时候我们谈过他有一个

123
00:08:55,807 --> 00:09:01,183
你要叫他做特色吗有不好因为好像也没那么棒说是缺点吗也

124
00:09:01,951 --> 00:09:05,023
我直接说吧他到底是什么他只拿不还

125
00:09:06,303 --> 00:09:10,399
安娜娜娜一直在他手上他是不会还给操作系统

126
00:09:12,703 --> 00:09:15,519
这个不会影响你的是会影响其他人

127
00:09:15,775 --> 00:09:19,871
其他和你一起在同一个电脑上运作的那一些

128
00:09:20,639 --> 00:09:22,431
Brothers那些进程

129
00:09:23,455 --> 00:09:25,759
我们都被拿去了那他们就用不到了

130
00:09:27,295 --> 00:09:29,087
当时曾经提过

131
00:09:29,599 --> 00:09:32,927
他的做法这个做法没有改善他现在仍然是这样

132
00:09:38,559 --> 00:09:40,607
好下一页这个是

133
00:09:40,863 --> 00:09:41,631
用法

134
00:09:41,887 --> 00:09:43,935
就是这个我们在第二章也谈过了

135
00:09:44,447 --> 00:09:46,751
所以我很快在跟你讲一下这一页是什么

136
00:09:47,007 --> 00:09:48,031
就是使用

137
00:09:48,287 --> 00:09:50,591
使用这一个东西

138
00:09:51,359 --> 00:09:52,639
写法

139
00:09:53,407 --> 00:09:55,711
搭配容器的话你要这么写

140
00:09:58,015 --> 00:10:03,647
或者直接用的话像我现在设计的左手边一个函数我直接要用

141
00:10:04,159 --> 00:10:07,999
传进去这里头呢我做30分配看看他的

142
00:10:08,255 --> 00:10:09,023
区隔

143
00:10:09,279 --> 00:10:12,095
结果我要看看是不是真的不在乎

144
00:10:14,911 --> 00:10:16,447
这边进去

145
00:10:16,703 --> 00:10:18,751
三个指针相聚

146
00:10:19,007 --> 00:10:20,543
就是元素大小

147
00:10:20,799 --> 00:10:22,591
藐视一切不大古迹

148
00:10:24,639 --> 00:10:28,479
不过我也曾经执行过执行的结果他并他是比

149
00:10:29,247 --> 00:10:30,783
元素大小还要大

150
00:10:31,807 --> 00:10:34,623
但这并不表示就带着工具

151
00:10:36,415 --> 00:10:37,439
因为也许

152
00:10:37,695 --> 00:10:41,023
你当时电脑的内存本来就是断断续续的

153
00:10:41,791 --> 00:10:44,607
他说我能够挖到了就是断断续续的

154
00:10:48,959 --> 00:10:55,103
好这个是上面使用这一种内存池的这种分配器下面就是用标准库的那种

155
00:10:55,359 --> 00:10:57,663
这个也传进去

156
00:10:58,431 --> 00:10:59,967
打印出来的三个

157
00:11:00,735 --> 00:11:01,759
绝对是

158
00:11:03,039 --> 00:11:05,855
比你想象中的距离还要多

159
00:11:06,111 --> 00:11:07,135
八个字节

160
00:11:09,951 --> 00:11:11,743
也就是他们带着工具

161
00:11:13,023 --> 00:11:14,303
总归一句话

162
00:11:14,559 --> 00:11:15,839
真正有用的

163
00:11:16,095 --> 00:11:17,119
分配器

164
00:11:17,375 --> 00:11:19,679
是这一种智能型的

165
00:11:20,447 --> 00:11:22,495
智能型的这是一种代表

166
00:11:22,751 --> 00:11:25,055
现在你所看到的这个是一种代表

167
00:11:25,311 --> 00:11:27,359
下一页可能是另外一种代表

168
00:11:28,895 --> 00:11:30,175
追求的都是

169
00:11:30,687 --> 00:11:32,223
希望能够不要哭泣

170
00:11:35,807 --> 00:11:37,599
终于我们到了

171
00:11:40,159 --> 00:11:41,695
这是一个大的话题

172
00:11:42,207 --> 00:11:44,255
它的源代码也非常的复杂

173
00:11:44,511 --> 00:11:50,655
不会带着大家来看源代码那个要花很多时间但是我把所有的源代码的精神

174
00:11:50,911 --> 00:11:52,447
动作以及华盛顿了

175
00:11:53,215 --> 00:11:55,775
大家来看看他的行为
